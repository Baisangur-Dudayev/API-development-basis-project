<html>
<head>
    <script defer src="https://unpkg.com/alpinejs@3.5.0/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>API Fronted</title>
</head>
<body x-data="{ username: '', password: '', accessToken: null }">

    <!----------------------------------------------------------------------->
 <div>
        <label for="username">Username:</label>
        <input type="text" id="username" x-model="username">
    </div>
    <div>
        <label for="password">Password:</label>
        <input type="password" id="password" x-model="password">
    </div>
    <div>
        <button x-on:click="login">Login</button>
    </div>
    <div x-show="accessToken">
        <p>Access Token: <strong x-text="accessToken"></strong></p>
    </div>

    <script>
        async function login() {
            const response = await fetch('https://useritem-api-service-baisangur-dudayev.cloud.okteto.net/token', {
                method: 'POST',
                body: new URLSearchParams({
                    'username': this.username,
                    'password': this.password,
                    'grant_type': 'password',
                }),
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
            });

            const responseData = await response.json();

            if (response.ok) {
                this.accessToken = responseData.access_token;
                console.log('Login successful:', responseData);
            } else {
                console.error('Login failed:', responseData);
            }
        }
    </script>
    <!----------------------------------------------------------------------->
    <div x-data="{
        responsedata: null,
        async getData() {
            this.responsedata = await (await fetch('https://useritem-api-service-baisangur-dudayev.cloud.okteto.net/authors/')).json();
        }
    }">
        <button x-on:click="getData">Send get request</button>

        <template x-if="responsedata !== null">
            <template x-for="(author, index) in responsedata" :key="index">
                <div>
                    <p>Email: <strong x-text="author.email">Placeholder</strong></p>
                    <p>Name: <strong x-text="author.first_name">Placeholder</strong></p>
                    <p>Surname: <strong x-text="author.last_name">Placeholder</strong></p>
                    <p>Biography: <strong x-text="author.biography">Placeholder</strong></p>
                    <p>ID: <strong x-text="author.id">Placeholder</strong></p>
                    <p>Books:</p>
                        <ul>
                            <template x-for="(book, bookIndex) in author.books" :key="bookIndex">
                                <div>
                                <li>Title: <strong x-text="book.title">Placeholder</strong></li>    
                                <li>Description: <strong x-text="book.description">Placeholder</strong></li>
                                <li>Publication Date: <strong x-text="book.publication_date">Placeholder</strong></li>
                                <li>Genre: <strong x-text="book.genre">Placeholder</strong></li>
                               
                                </div>
                            </template>
                        </ul>
             
                </div>
            </template>
        </template>
    </div>
</body>
</html>
